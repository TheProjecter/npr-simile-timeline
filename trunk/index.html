<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
<title>SIMILE Timeline of Stories from NPR</title>

<script language="javascript" TYPE="text/javascript">
window.station="KJZZ_FM";
window.localize=true;
</script>

<script src="http://simile.mit.edu/timeline/api/timeline-api.js" type="text/javascript"></script>

<script src="/scripts/jsonStringify.js" type="text/javascript"></script>

<script src="/scripts/json2.js" type="text/javascript"></script>

<script language="javascript" TYPE="text/javascript">


// pause script to pause computer
// http://www.sean.co.uk/a/webdesign/javascriptdelay.shtm
function pausecomp(millis)
{
var date = new Date();
var curDate = null;

do { curDate = new Date(); }
while(curDate-date < millis);
} 


</script>

<script language="javascript" TYPE="text/javascript">
// from the simile cubism tutorial
// http://simile.mit.edu/timeline/examples/cubism/cubism.html
var tl;
function onLoad(newjsondata) {

	entries = newjsondata.list

	var eventSource = new Timeline.DefaultEventSource();

/*
	// from example here: 
	//Generate 50 random events up to 20 days in the past or the future
	for(var i=0;i<50;i++) {
	var dateEvent = new Date();
	dateEvent.setTime(dateEvent.getTime() + ((Math.floor(Math.random()*41) - 20) * 24 * 60 * 60 * 1000));
	var evt = new Timeline.DefaultEventSource.Event(
		dateEvent, //start
		dateEvent, //end
		dateEvent, //latestStart
		dateEvent, //earliestEnd
		true, //instant
		"Event " + i, //text
		"Description for Event " + i //description
		);

*/      
      // start new code
      	var x;
	// for (x = 0; x < entries.count ; x++){
	for (x = 0; x < 3 ; x++){
		// alert(x);
		nprico = "http://npr.org/favicon.ico"
		color = "green"
		
		var evt = new Timeline.DefaultEventSource.Event(
		entries.story[x].storyDate.$text, //start
		entries.story[x].storyDate.$text, //end
		entries.story[x].storyDate.$text, //latestStart
		entries.story[x].storyDate.$text, //earliestEnd
		true, //instant
		entries.story[x].title.$text, //text
		entries.story[x].teaser.$text, // description
		nprico, // image
		entries.story[x].link[0].$text, // link
		nprico, // icon
		color // color
		);
		// alert(JSONstring.make(evt));

		// end new code
	eventSource.add(evt);

  }

pausecomp(1000);
alert(JSONstring.make(eventSource));

//create the timeline
  var bandInfos = [
    Timeline.createBandInfo({
        trackGap:       0.2,
        width:          "70%",
        intervalUnit:   Timeline.DateTime.WEEK,
        intervalPixels: 100,
        eventSource: eventSource
    }),
    Timeline.createBandInfo({
        showEventText:  false,
        trackHeight:    0.5,
        trackGap:       0.2,
        width:          "30%",
        intervalUnit:   Timeline.DateTime.YEAR,
        intervalPixels: 150,
        eventSource: eventSource
    })
  ];
  bandInfos[1].syncWith = 0;
  bandInfos[1].highlight = true;
  tl = Timeline.create(document.getElementById("my-timeline"), bandInfos);

}

var resizeTimerID = null;
function onResize() {
    if (resizeTimerID == null) {
        resizeTimerID = window.setTimeout(function() {
            resizeTimerID = null;
            tl.layout();
        }, 500);
    }
}
</script>

<script language="javascript" TYPE="text/javascript">

function ws_results(obj) {
	// alert(obj.list.title.$text);
}
</script>



</head>
<body  onresize="onResize();" >
<!-- 
<body onload="onLoad();" onresize="onResize();" >
-->
<h1 style="text-transform: capitalize;">Timeline of Stories from NPR</h1>


<div id="body">

    <div id="my-timeline" class="timeline-default" style="height: 300px;">
    </div>
    
</div>

<!--
Query for the election:
<script src="http://api.npr.org/query?id=1102&fields=title,teaser,storyDate,audio,image,summary&action=Or&output=JSON&apiKey=MDAxNzgwMDQ5MDEyMTQ4NzYyMjU4YmY1Yw004&callback=timelineConverter" type="text/javascript"></script>
-->
<!--
query for arts -->
<script src="http://api.npr.org/query?id=1008&fields=title,teaser,storyDate,audio,image,summary&action=Or&output=JSON&apiKey=MDAxNzgwMDQ5MDEyMTQ4NzYyMjU4YmY1Yw004&callback=onLoad" type="text/javascript"></script>
</body>
</html>